<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Apache Virtual Hosts - Beginner Training & Lab (Ubuntu)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.65; background:#f7f7fb; color:#1f2937; }
    h1,h2,h3 { color:#111827; }
    .toc a { text-decoration:none; }
    .box { background:#fff; padding:18px 18px; margin:16px 0; border-radius:10px; box-shadow:0 1px 6px rgba(0,0,0,0.08); }
    .note { border-left:6px solid #f59e0b; }
    .lab  { border-left:6px solid #10b981; }
    .info { border-left:6px solid #3b82f6; }
    code, pre { background:#eef2ff; padding:10px; display:block; border-radius:8px; overflow-x:auto; }
    .inline { display:inline; padding:2px 6px; border-radius:6px; }
    ul li { margin: 6px 0; }
    hr { border:none; border-top:1px solid #e5e7eb; margin:28px 0; }
    .small { font-size: 0.95em; color:#374151; }
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } }
  </style>
</head>

<body>

<h1>Apache Virtual Hosts – Beginner Training + Lab (Ubuntu)</h1>

<div class="box note">
  <b>Audience:</b> Beginners (Linux/DevOps/Web fundamentals)<br>
  <b>OS:</b> Ubuntu 20.04 / 22.04 / 24.04<br>
  <b>Apache:</b> 2.4 (default on Ubuntu)<br>
  <b>Goal:</b> Understand Web Server concepts + Apache directory structure + Create Virtual Hosts (1 & multiple).
</div>

<div class="box info toc">
  <b>Table of Contents</b>
  <ol>
    <li><a href="#webserver">Web Server Concepts (Beginner)</a></li>
    <li><a href="#http">How HTTP Requests Reach Your Website</a></li>
    <li><a href="#apache">Apache Basics</a></li>
    <li><a href="#dirstructure">Apache Directory Structure (Ubuntu) – Detailed</a></li>
    <li><a href="#vhosts">Virtual Hosts Concept</a></li>
    <li><a href="#lab1">LAB 1: Create First Virtual Host (site1.local)</a></li>
    <li><a href="#lab2">LAB 2: Create Multiple Virtual Hosts (site1.local + site2.local)</a></li>
    <li><a href="#logs">Logs, Debugging, and Validation</a></li>
    <li><a href="#practice">Practice Task</a></li>
  </ol>
</div>

<hr>

<h2 id="webserver">1) Web Server Concepts (Beginner)</h2>

<div class="box info">
  <h3>1.1 What is a Web Server?</h3>
  <p>
    A <b>web server</b> is software (and the machine running it) that delivers websites and web APIs to users.
    When you open a website in your browser, your browser sends a request, and the web server sends back a response.
  </p>

  <h3>1.2 What does a Web Server do?</h3>
  <ul>
    <li><b>Listens</b> on network ports (usually <span class="inline" style="background:#dbeafe;">80</span> for HTTP and <span class="inline" style="background:#dbeafe;">443</span> for HTTPS).</li>
    <li><b>Accepts HTTP requests</b> from clients (browser, curl, mobile apps).</li>
    <li><b>Serves content</b>:
      <ul>
        <li><b>Static content:</b> HTML, CSS, JS, images (files stored on disk).</li>
        <li><b>Dynamic content:</b> content generated by an application (PHP, Python, Node, Java, etc.).</li>
      </ul>
    </li>
    <li><b>Routes requests</b> to the right website / application using rules (Virtual Hosts, URL paths, reverse proxy).</li>
    <li><b>Logs activity</b> for troubleshooting (access logs and error logs).</li>
    <li><b>Security & controls</b> (TLS/SSL, headers, access rules, authentication).</li>
  </ul>

  <h3>1.3 Static vs Dynamic Web Content</h3>
  <div class="grid">
    <div class="box">
      <b>Static Website</b>
      <ul>
        <li>Apache reads file from disk and returns it.</li>
        <li>Fast and simple.</li>
        <li>Example: <span class="inline" style="background:#eef2ff;">index.html</span></li>
      </ul>
    </div>
    <div class="box">
      <b>Dynamic Website</b>
      <ul>
        <li>Apache forwards request to an app (PHP-FPM, Python, etc.).</li>
        <li>App generates response (often uses DB).</li>
        <li>Example: WordPress, Django app, APIs.</li>
      </ul>
    </div>
  </div>

  <h3>1.4 Common Web Servers</h3>
  <ul>
    <li><b>Apache HTTP Server</b> (this training)</li>
    <li><b>Nginx</b> (popular reverse proxy + static server)</li>
    <li><b>Caddy</b> (simple + automatic HTTPS)</li>
    <li><b>IIS</b> (Microsoft Windows)</li>
  </ul>
</div>

<hr>

<h2 id="http">2) How HTTP Requests Reach Your Website</h2>

<div class="box info">
  <p><b>Simple request flow:</b></p>
  <pre>
User types URL in browser
    ↓
DNS resolves domain → IP address
    ↓
Browser connects to IP on port 80/443
    ↓
Browser sends HTTP request (GET /)
    ↓
Apache receives request
    ↓
Apache selects correct VirtualHost (ServerName match)
    ↓
Apache returns response (HTML/CSS/JS or app output)
  </pre>

  <h3>2.1 DNS and /etc/hosts (for local labs)</h3>
  <p>
    In real life, DNS is handled by a DNS server (Cloudflare, Route53, etc.).
    In a local lab, we simulate DNS using <span class="inline" style="background:#fee2e2;">/etc/hosts</span> so that:
  </p>
  <pre>
site1.local → 127.0.0.1
site2.local → 127.0.0.1
  </pre>
  <p class="small">
    This means: when your browser asks "where is site1.local?", your system replies "it is on localhost".
  </p>

  <h3>2.2 Ports: 80 and 443</h3>
  <ul>
    <li><b>80</b> = HTTP (not encrypted)</li>
    <li><b>443</b> = HTTPS (encrypted with TLS/SSL)</li>
  </ul>
</div>

<hr>

<h2 id="apache">3) Apache Basics</h2>

<div class="box info">
  <h3>3.1 What is Apache?</h3>
  <p>
    Apache HTTP Server is one of the most widely used web servers.
    It can serve static files, host multiple sites, and integrate with many app technologies.
  </p>

  <h3>3.2 Important Apache terms</h3>
  <ul>
    <li><b>DocumentRoot</b>: Folder where site files live (e.g., index.html).</li>
    <li><b>VirtualHost</b>: A website definition inside Apache.</li>
    <li><b>Module</b>: Feature plugin (e.g., rewrite, ssl).</li>
    <li><b>Directive</b>: Apache config instruction (e.g., ServerName).</li>
  </ul>
</div>

<hr>

<h2 id="dirstructure">4) Apache Directory Structure (Ubuntu) – Detailed Explanation</h2>

<div class="box info">
  <p>Ubuntu uses a clean split between <b>available</b> and <b>enabled</b> configs.</p>

  <h3>4.1 Key directories and what they do</h3>

  <div class="box">
    <b>/etc/apache2/</b> (Main Apache configuration directory)
    <ul>
      <li>Contains almost all Apache configuration files.</li>
      <li>Think of this as Apache’s “control room”.</li>
    </ul>
  </div>

  <div class="grid">
    <div class="box">
      <b>/etc/apache2/apache2.conf</b>
      <ul>
        <li>Main configuration file.</li>
        <li>Includes other configs (mods, sites, conf).</li>
        <li>You typically don’t place VirtualHost blocks here on Ubuntu (best practice: use sites-available).</li>
      </ul>
    </div>

    <div class="box">
      <b>/etc/apache2/ports.conf</b>
      <ul>
        <li>Defines which ports Apache listens on.</li>
        <li>Common lines: Listen 80, Listen 443.</li>
        <li>If you add a new port (e.g., 8080), you add Listen here.</li>
      </ul>
    </div>
  </div>

  <div class="grid">
    <div class="box">
      <b>/etc/apache2/sites-available/</b>
      <ul>
        <li>All Virtual Host config files live here.</li>
        <li>Examples: <span class="inline" style="background:#eef2ff;">000-default.conf</span>, <span class="inline" style="background:#eef2ff;">site1.local.conf</span></li>
        <li>“Available” means: present but not necessarily active.</li>
      </ul>
    </div>

    <div class="box">
      <b>/etc/apache2/sites-enabled/</b>
      <ul>
        <li>Enabled/active websites (Virtual Hosts).</li>
        <li>Contains <b>symlinks</b> pointing to files in sites-available.</li>
        <li><b>a2ensite</b> creates symlink here, <b>a2dissite</b> removes it.</li>
      </ul>
    </div>
  </div>

  <div class="grid">
    <div class="box">
      <b>/etc/apache2/mods-available/</b>
      <ul>
        <li>All available modules (features) are stored here.</li>
        <li>Example modules: rewrite, ssl, headers.</li>
      </ul>
    </div>

    <div class="box">
      <b>/etc/apache2/mods-enabled/</b>
      <ul>
        <li>Enabled modules (symlinks to mods-available).</li>
        <li><b>a2enmod</b> enables modules, <b>a2dismod</b> disables.</li>
      </ul>
    </div>
  </div>

  <div class="grid">
    <div class="box">
      <b>/etc/apache2/conf-available/</b>
      <ul>
        <li>Extra/global configuration snippets (not per-site).</li>
        <li>Good for shared settings (security headers, custom defaults).</li>
      </ul>
    </div>

    <div class="box">
      <b>/etc/apache2/conf-enabled/</b>
      <ul>
        <li>Enabled conf snippets (symlinks to conf-available).</li>
        <li><b>a2enconf</b> enables, <b>a2disconf</b> disables.</li>
      </ul>
    </div>
  </div>

  <div class="grid">
    <div class="box">
      <b>/var/www/</b>
      <ul>
        <li>Recommended place to store website files.</li>
        <li>Common layout: <span class="inline" style="background:#eef2ff;">/var/www/site1.local/public_html</span></li>
      </ul>
    </div>

    <div class="box">
      <b>/var/log/apache2/</b>
      <ul>
        <li>Apache logs live here.</li>
        <li><b>Access logs</b>: who visited, what URL, status code.</li>
        <li><b>Error logs</b>: config issues, permission errors, runtime problems.</li>
      </ul>
    </div>
  </div>

  <h3>4.2 Commands that manage symlinks (Ubuntu helpers)</h3>
  <pre>
a2ensite / a2dissite   → enable/disable a website (VirtualHost)
a2enmod  / a2dismod    → enable/disable a module
a2enconf / a2disconf   → enable/disable a config snippet
  </pre>
</div>

<hr>

<h2 id="vhosts">5) Virtual Hosts Concept (Simple)</h2>

<div class="box info">
  <p>
    A <b>VirtualHost</b> is a block of configuration that tells Apache:
  </p>
  <ul>
    <li>Which domain name to match (<b>ServerName</b>)</li>
    <li>Where website files live (<b>DocumentRoot</b>)</li>
    <li>Where to store logs (<b>ErrorLog</b>, <b>CustomLog</b>)</li>
  </ul>

  <pre>
<VirtualHost *:80>
  ServerName site1.local
  DocumentRoot /var/www/site1.local/public_html
</VirtualHost>
  </pre>
</div>

<hr>

<h2 id="lab1">6) LAB 1 – Create First Virtual Host (site1.local)</h2>

<div class="box lab">
  <h3>Objective</h3>
  Create and access: <b>http://site1.local</b>
</div>

<h3>Step 1: Install Apache</h3>
<pre>
sudo apt update
sudo apt install apache2 -y
</pre>

<h3>Step 2: Create Website Directory</h3>
<pre>
sudo mkdir -p /var/www/site1.local/public_html
sudo chown -R $USER:$USER /var/www/site1.local
sudo chmod -R 755 /var/www
</pre>

<h3>Step 3: Create Test Web Page</h3>
<pre>
nano /var/www/site1.local/public_html/index.html
</pre>
<pre>
<h1>Site1 Virtual Host Working</h1>
</pre>

<h3>Step 4: Create Virtual Host Config</h3>
<pre>
sudo nano /etc/apache2/sites-available/site1.local.conf
</pre>

<pre>
<VirtualHost *:80>
    ServerName site1.local
    ServerAlias www.site1.local
    DocumentRoot /var/www/site1.local/public_html

    <Directory /var/www/site1.local/public_html>
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/site1_error.log
    CustomLog ${APACHE_LOG_DIR}/site1_access.log combined
</VirtualHost>
</pre>

<h3>Step 5: Enable Site + Disable Default</h3>
<pre>
sudo a2ensite site1.local.conf
sudo a2dissite 000-default.conf
</pre>

<h3>Step 6: Test Config + Reload</h3>
<pre>
sudo apache2ctl configtest
sudo systemctl reload apache2
</pre>

<h3>Step 7: Map Domain Locally (hosts file)</h3>
<pre>
sudo nano /etc/hosts
</pre>
<pre>
127.0.0.1 site1.local
</pre>

<h3>Validation</h3>
<pre>
Open: http://site1.local
</pre>

<hr>

<h2 id="lab2">7) LAB 2 – Multiple Virtual Hosts (site1.local + site2.local)</h2>

<div class="box lab">
  <h3>Objective</h3>
  Run two websites on same Apache server.
</div>

<h3>Step 1: Create Site2 folders + page</h3>
<pre>
sudo mkdir -p /var/www/site2.local/public_html
sudo chown -R $USER:$USER /var/www/site2.local
nano /var/www/site2.local/public_html/index.html
</pre>
<pre>
<h1>Site2 Virtual Host Working</h1>
</pre>

<h3>Step 2: Create site2 VirtualHost config</h3>
<pre>
sudo nano /etc/apache2/sites-available/site2.local.conf
</pre>

<pre>
<VirtualHost *:80>
    ServerName site2.local
    DocumentRoot /var/www/site2.local/public_html

    <Directory /var/www/site2.local/public_html>
        Require all granted
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/site2_error.log
    CustomLog ${APACHE_LOG_DIR}/site2_access.log combined
</VirtualHost>
</pre>

<h3>Step 3: Enable site2 + Reload</h3>
<pre>
sudo a2ensite site2.local.conf
sudo systemctl reload apache2
</pre>

<h3>Step 4: Update hosts file</h3>
<pre>
sudo nano /etc/hosts
</pre>
<pre>
127.0.0.1 site1.local
127.0.0.1 site2.local
</pre>

<h3>Validation</h3>
<pre>
Open: http://site1.local
Open: http://site2.local
</pre>

<hr>

<h2 id="logs">8) Logs, Debugging, and Validation</h2>

<div class="box info">
  <h3>8.1 Check enabled sites</h3>
  <pre>
ls -l /etc/apache2/sites-enabled/
  </pre>

  <h3>8.2 Check which VirtualHosts Apache sees</h3>
  <pre>
sudo apache2ctl -S
  </pre>

  <h3>8.3 Tail logs</h3>
  <pre>
tail -f /var/log/apache2/site1_error.log
tail -f /var/log/apache2/site1_access.log
  </pre>

  <h3>8.4 Common Problems</h3>
  <ul>
    <li><b>403 Forbidden</b>: permissions or missing <span class="inline" style="background:#eef2ff;">Require all granted</span></li>
    <li><b>Default page still shows</b>: default site not disabled OR ServerName mismatch</li>
    <li><b>Apache reload fails</b>: syntax error → run <span class="inline" style="background:#eef2ff;">sudo apache2ctl configtest</span></li>
  </ul>
</div>

<hr>

<h2 id="practice">9) Practice Task (For Students)</h2>

<div class="box lab">
  <h3>Task</h3>
  <ol>
    <li>Create a new website folder: <b>/var/www/training.local/public_html</b></li>
    <li>Create an index page showing: “training.local working”</li>
    <li>Create config: <b>/etc/apache2/sites-available/training.local.conf</b></li>
    <li>Enable it using <b>a2ensite</b></li>
    <li>Add entry in <b>/etc/hosts</b></li>
    <li>Open in browser: <b>http://training.local</b></li>
  </ol>
</div>

<div class="box note">
  <b>Next module ideas (optional):</b> HTTPS (Let’s Encrypt), rewrite rules, reverse proxy, PHP integration, Apache security headers.
</div>

<p class="small"><b>End of Training & Lab Manual</b></p>

</body>
</html>
  
